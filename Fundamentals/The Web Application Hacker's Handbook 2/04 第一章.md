# 04 第一章 Web应用（不）安全性

毫无疑问，网络应用程序安全性是一个当前热门且备受关注的话题。对于所有相关方来说，风险都非常高：对于依赖互联网商务增加收入的企业，对于信任网络应用程序处理敏感信息的个人用户，以及那些通过窃取支付信息或入侵银行账户牟取暴利的犯罪分子而言，更是如此。声誉在其中扮演着至关重要的角色。很少有人愿意与一个不安全的网站进行交易，因此很少有组织愿意公开自己的安全漏洞或数据泄露事件。因此，要获得关于当前网络应用程序安全状况的可靠信息并非易事。

本章将简要回顾网络应用的演变过程及其带来的诸多益处。我们根据作者的直接经验，提供了一些关于当前网络应用漏洞的指标，表明大多数应用远未达到安全标准。我们将描述网络应用面临的核心安全问题——用户可以提供任意输入——以及导致其安全态势薄弱的各种因素。最后，我们将介绍网络应用安全领域的最新趋势及其未来发展可能的方向。

## 网络应用的演变

互联网早期，万维网仅由网站组成。这些网站本质上是包含静态文档的信息仓库。网页浏览器被发明出来用于检索和显示这些文档，如图1-1所示。信息的流动是单向的，从服务器到浏览器。大多数网站不需要进行用户认证，因为没有必要。每个用户都被同等对待，并呈现相同的信息。与托管网站相关的任何安全威胁主要与web服务器软件的漏洞有关（其中有很多）。如果攻击者入侵了web服务器，通常不会获得任何敏感信息，因为服务器上的信息已经公开可见。相反，攻击者通常会修改服务器上的文件来篡改网站内容，或利用服务器的存储和带宽分发“盗版软件”。

![](https://github.com/owl234/Awesome-SRC-experience/blob/main/img\00%20Dafydd%20Stuttard,%20Marcus%20Pinto%20-%20The%20Web%20Application%20Hacker's%20Handbook_%20finding%20and%20exploiting%20security%20flaws-Wiley%20(2011).jpg)

图1-1：传统只包含静态信息的网站

今天，万维网与早期的形态几乎完全不同。网络上的大多数站点实际上都是应用程序（见图1-2）。它们功能强大，依赖于服务器和浏览器之间的双向信息流。它们支持注册和登录、金融交易、搜索、以及用户生成内容。呈现给用户的内容是动态生成的，并且经常为每个特定的用户量身定制。处理的大部分信息都是私密且高度敏感的。因此，安全是一个大问题。如果有人认为自己的信息会被泄露给未经授权的一方，那么没有人会愿意使用一个网络应用程序。

![](https://github.com/owl234/Awesome-SRC-experience/blob/main/img\00%20Dafydd%20Stuttard,%20Marcus%20Pinto%20-%20The%20Web%20Application%20Hacker's%20Handbook_%20finding%20and%20exploiting%20security%20flaws-Wiley%20(2011)1.jpg)

图1-2：典型的Web应用

网络应用程序带来了新的、重大的安全威胁。每个应用程序都不同，可能包含独特的漏洞。大多数应用程序都是内部开发的——许多是由仅部分了解可能在他们编写的代码中出现的安全问题的开发人员开发的。为了提供其核心功能，网络应用程序通常需要连接到包含高度敏感数据并可以执行强大业务功能的内部计算机系统。十五年前，如果你想进行资金转账，你需要去银行，由柜员为你办理转账；今天，你可以访问一个网络应用程序并自动进行转账。攻击者可以入侵网络应用程序，窃取个人信息，进行金融欺诈，并对其他用户执行恶意操作。

## 常见的网络应用程序功能

网络应用程序几乎可以实现任何在线可用的功能。以下是近年来突出的几种网络应用程序功能：

- 购物（亚马逊）

- 社交网络（脸书）

- 银行业务（花旗银行）

- 网页搜索（谷歌）

- 拍卖（eBay）

- 赌博（Betfair）

- 博客（Blogger）

- 网邮（Gmail）

- 交互式信息（维基百科）

使用计算机浏览器访问的应用程序与使用智能手机或平板电脑访问的移动应用程序之间越来越重叠。大多数移动应用程序使用浏览器或自定义客户端，通过基于HTTP的API与服务器通信。应用程序功能和数据通常在应用程序向不同用户平台公开的各种界面之间共享。

除了公共互联网，网络应用程序已被广泛应用于组织内部以支持关键业务功能。其中许多提供对高度敏感数据和功能的访问。

- 人力资源应用程序，允许用户访问薪资信息，提供和接收绩效反馈，以及管理招聘和纪律程序。

- 关键基础设施的管理界面，例如web和邮件服务器、用户工作站和虚拟机管理。

- 协作软件用于共享文档、管理工作流程和项目，以及跟踪问题。这些类型的功能通常涉及关键的安全和治理问题，组织经常完全依赖于其网络应用程序中内置的控制措施。

- 业务应用程序，例如企业资源规划（ERP）软件，以及使用专有的客户端应用程序访问，现在可以使用web浏览器访问。

- 软件服务，例如电子邮件，最初需要单独的电子邮件客户端，现在可以通过Outlook Web Access等web界面访问。

- 传统的桌面办公应用程序，如文字处理器和电子表格，已经通过Google apps和Mircrosoft Office Live 等服务迁移到web应用程序。

在所有这些例子中，被视为“内部”的应用程序越来越多地被外部托管，因为组织转向外部服务提供商以降低成本。在这些所谓的云解决方案中，关键业务功能和数据对更广泛的潜在攻击者开放，组织越来越依赖于其控制之外的安全访问的完整性。

大多数计算机用户唯一需要的客户端软件即将到来，那就是web浏览器。各种各样的功能将使用一组共享的协议和技术实现，从而继承了一系列独特的常见安全漏洞。

## 网络应用程序的优势

不难看出，网络应用程序为何能如此迅速地崛起。除了明显的商业激励因素外，一些技术因素也推动了我们使用互联网方式的革命。

- **HTTP** 是用于访问万维网的核心通信协议，轻量级且无连接。这在通信错误的情况下提供了弹性，并避免了服务器需要为每个用户保持网络连接的需要，正如许多传统客户端/服务器应用程序中的情况一样。HTTP还可以通过其他协议进行代理和隧道传输，允许在任何网络配置中进行安全通信。

- **每个网络用户已经在其计算机和移动设备上安装了浏览器。** 网络应用程序动态地将用户界面部署到浏览器，避免了分发和管理单独客户端软件的需要，就像web应用程序的情况一样。界面更改只需在服务器上实现一次，并立即生效。

- 现在的浏览器功能强大，能够构建丰富灵人满意的用户界面。Web界面使用的标准的导航和输入控件，用户可以立即熟悉，避免了学习每个应用程序的独特功能的需要。客户端脚本使应用程序能够将其部分处理过程推送到客户端，并在必要时可以使用浏览器扩展技术以任意方式扩展浏览器的功能。

- **开发网络应用程序所用的核心技术和语言相对简单。** 有大量的平台和开发工具可供使用，使相对初学者也能开发出强大的应用程序，并且有大量开源代码和其他资源可用于整合到定制的应用程序中。

## 网络应用程序安全

与人任何新型技术一样，网络应用程序带来了一系列新的安全漏洞。最常见的缺陷的集合随着时间的推移有所演变。开发现有的程序时未考虑到新的攻击出现。随着人们对某些问题的认识提高，这些问题变得不那么普遍了。新技术的开发引入了新的可利用可能性。犹豫对web浏览器软件的更改，某些类型的缺陷已基本消失。

针对网络应用程序最严重的攻击是那些暴露敏感数据或无限制访问应用程序运行所在后端系统的攻击。此类高知名度的泄露事件继续频繁发生。然而，对于多组织来说，任何导致系统停机的攻击都是一个关键事件。应用程序级别的拒绝服务攻击可以用来实现与针对基础设施的传统资源耗尽攻击相同的结果。但是，它们通常使用更微妙的技术和目标。它们可能被用来破坏特定的用户或服务，以获得在金融交易、游戏、在线竞拍和票务预订领域相对于同行的竞争优势。

在整个演变过程中，知名网络应用程序的泄露事件一直占据新闻头条。没有迹象表明情况已经好转，这些安全问题正在减少。从某种程度来说，网络应用程序安全是当今攻击者和拥有计算机资源和数据需要保护的人之间最重要的战场。

### “这个网站是安全的”

热门普遍意识到网络应用程序存在的安全问题。查看应用程序的常见问题解答页面，你会得到关于其安全的保证。

大多数应用程序称它们是安全的，因为它们使用了SSL。例如：
本网站绝对安全。它设计并使用了128位安全套接层（SSL）技术，以防止未经授权的用户查看你的任何信息。你可以放心使用本网站，你的数据在我们这里安全无虞。

用户经常被敦促验证网站证书，赞赏其使用的先进加密协议，并在此基础上信任其个人信息。越来越多地组织还引用其对支付行业（PIC）标准的遵守来向用户保证其安全性。例如：我们非常重视安全。我们的网站每天都会进行扫描，已确保我们保持PCI合规并免受黑客攻击。你可以在下面的徽标上查看最新扫描日期，并保证我们的网站安全使用。

实际上，尽管广泛使用SSL技术和定期进行PCI扫描，大多数网络应用程序都不安全。本书作者近年来测试了数百个网络应用程序。图1-3显示了2007年和2011年期间测试的应用程序中受某些常见漏洞类别影响的百分比。

- **身份验证失效** （62%）-此类漏洞包含应用程序登录机制中的各种缺陷，可能使攻击者猜测弱密码、发起暴力破解攻击或绕过登录。

- **访问控制失效（71%）** - 这涉及应用程序未能正确保护其数据和功能访问的情况，可能使攻击者查看服务器上保存的其他用户的敏感数据或执行特权操作。

- **SQL注入（32%）** -   此漏洞使攻击者能够提交精心制作的输入来干扰应用程序与后端数据库的交互。攻击者可能能够从应用程序检索任意数据、干扰其逻辑或在数据库服务器本身上执行命令。

- **跨站脚本攻击（94%）** - 此漏洞使攻击者能够针对应用程序的其他用户，潜在访问它们的数据，代表它们执行未经授权的操作或对它们进行其他攻击。

- **信息泄露（78%）** - 这涉及应用程序泄露敏感信息的情况，这些信息可用于攻击者开发针对应用程序进行攻击，通过有缺陷道德错误处理或其他行为。

- **跨站请求伪造（92%）**- 此缺陷意味着应用程序用户可以被诱导在它们的用户上下文和权限级别上执行非预期操作。该漏洞允许恶意网站访问受害者用户并与应用程序交互，执行用户无意执行的操作。

![](https://github.com/owl234/Awesome-SRC-experience/blob/main/img\Snipaste_2024-08-05_16-48-45.jpg)

> 图1-3 ：作者最近测试的一百多个应用程序，一些常见Web应用程序漏洞的发生率如上所示。

SSL是一种优秀的技术，可以保护用户浏览器和Web服务器之间传输数据的机密性和完整性。它有助于防御窃听，并可以向用户保证他正在处理的Web服务器的身份。但它无法阻止直接针对应用程序服务器或客户端组件的攻击，而大多数成功的攻击正是如此。具体来说，它无法阻止刚刚列出的任何漏洞，也无法阻止许多其他可能使应用程序严重暴露于攻击的漏洞。无论是否使用SSL，大多数Web应用程序仍然包含安全缺陷。

### 核心安全问题：用户可以提交任意输入

与大多数分布式应用程序一样，网络应用程序面临着一个必须解决的基本安全问题。由于客户端不受应用程序控制，用户可以向服务器端应用程序提交任意输入。应用程序必须假设所有输入都可能是恶意的。因此，它必须采取措施确保攻击者无法使用精心制作的输入干扰应用程序的逻辑和行为，从而获得对其数据和功能的未授权访问。
